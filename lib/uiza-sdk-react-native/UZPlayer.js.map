{"version":3,"sources":["../../src/UZPlayer.js"],"names":["UZPlayer","props","debug","Logger","enableDebug","initTime","Date","now","self","size","Dimensions","get","state","playbackStatus","fullsceenState","FullscreenState","EXIT","fullscreenWidth","width","height","fullscreenHeight","player","VERSION","container","Promise","resolve","Constants","getWebViewUserAgentAsync","then","res","userAgent","deviceId","sessionId","didJustFinish","inited","listener","onError","evt","onFullscreenUpdate","onFullscreenChange","skin","updateState","fullscreen","ENTER","onLoad","onLoaded","onLoadStart","onPlaybackStatusUpdate","show","isPlaying","onPlaybackChange","pluginManager","updatePlaybackStatus","onReadyForDisplay","PluginManager","entityDetail","stream","API","getEntityDetail","api","token","entityId","getPlaybackToken","appId","playbackToken","cdnListFull","cdnList","getCDNVod","env","getCDNLive","streamName","region","data","cdn","all","cdns","map","push","host","init","ENTERING","exitFullscreen","enterFullscreen","e","StatusBar","setHidden","setState","ScreenOrientation","allow","Orientation","LANDSCAPE","EXITING","ALL","pause","play","video","pauseAsync","position","emit","playAsync","playFromPositionAsync","positionMillis","setPositionAsync","durationMillis","forceSeek","height169","Math","floor","view","styles","zIndex","top","left","component","Expo","Video","RESIZE_MODE_CONTAIN","onReady","url","definedLinkPlayVod","definedLinkPlayLive","loadAsync","uri","setStatusAsync","isLooping","shouldPlay","hide","message","readyTime","pageLoadTime","prefix","Platform","OS","parseInt","Version","playerName","PlayerEvent","React","Component","StyleSheet","create","backgroundColor"],"mappings":"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","file":"UZPlayer.js","sourcesContent":["import React from 'react';\nimport { Animated, Dimensions, Platform, StatusBar, StyleSheet, TouchableWithoutFeedback, View } from 'react-native';\nimport { Constants, ScreenOrientation, Video } from 'expo';\nimport Utils, { Logger } from './utils/Utils';\n\nimport API from './API';\nimport SkinUiza from './skins/uiza/Layout';\nimport PluginManager from './plugins/PluginManager';\nimport PlayerEvent from './Event';\nimport { ControlState, FullscreenState } from './skins/State';\n\nexport default class UZPlayer extends React.Component {\n  constructor(props) {\n    if (!!props.debug) {\n      Logger.enableDebug = true;\n    }\n    super(props);\n\n    this.initTime = Date.now();\n\n    let self = this;\n\n    const size = Dimensions.get('screen');\n\n    this.state = {\n      playbackStatus: {},\n      fullsceenState: FullscreenState.EXIT,\n      fullscreenWidth: size.width > size.height ? size.width : size.height,\n      fullscreenHeight: size.height < size.width ? size.height : size.width,\n    };\n\n    this.player = {\n      VERSION: '1.0.0'\n    };\n    this.container = {};\n\n    Promise.resolve(Constants.getWebViewUserAgentAsync()).then(function(res) {\n      self.player.userAgent = res;\n    });\n    this.player.deviceId = Constants.deviceId;\n    this.player.sessionId = Constants.sessionId;\n    this.player.didJustFinish = false;\n    this.player.inited = false;\n    this.player.props = props;\n\n    this.player.listener = {\n      onError: function(evt) {\n        Logger.debug('onError');\n        if (self.player.props && self.player.props.listener && typeof self.player.props.listener.onError === 'function') {\n          self.player.props.listener.onError(evt);\n        }\n      },\n      onFullscreenUpdate: function(evt) {\n        Logger.debug('onFullscreenUpdate');\n        // switch (evt.fullscreenUpdate) {\n        //   case PlayerEvent.FULLSCREEN_WILL_ENTER:\n        //     self.state.fullsceenState = FullscreenState.ENTERING;\n        //     break;\n        //   case PlayerEvent.FULLSCREEN_DID_ENTER:\n        //     self.state.fullsceenState = FullscreenState.ENTER;\n        //     break;\n        //   case PlayerEvent.FULLSCREEN_WILL_EXIT:\n        //     self.state.fullsceenState = FullscreenState.EXITING;\n        //     break;\n        //   case PlayerEvent.FULLSCREEN_DID_EXIT:\n        //     self.state.fullsceenState = FullscreenState.EXIT;\n        //     break;\n        // }\n        if (self.player.props && self.player.props.listener && typeof self.player.props.listener.onFullscreenChange === 'function') {\n          self.player.props.listener.onFullscreenChange(evt);\n        }\n\n        self.skin.updateState({ fullscreen: evt === FullscreenState.ENTER });\n      },\n      onLoad: function(evt) {\n        Logger.debug('onLoad');\n        // self.player.video.setPositionAsync(60000);\n        if (self.player.props && self.player.props.listener && typeof self.player.props.listener.onLoaded === 'function') {\n          self.player.props.listener.onLoaded(evt);\n        }\n      },\n      onLoadStart: function(evt) {\n        Logger.debug('onLoadStart');\n        // self.player.video.initialStatus({ positionMillis: 60000 });\n        if (self.player.props && self.player.props.listener && typeof self.player.props.listener.onLoad === 'function') {\n          self.player.props.listener.onLoad(evt);\n        }\n      },\n      onPlaybackStatusUpdate: function(evt) {\n        Logger.debug('onPlaybackStatusUpdate');\n        self.state.playbackStatus = evt;\n        if (self.state.playbackStatus.didJustFinish) {\n          self.player.didJustFinish = true;\n          self.skin.show();\n        } else if (self.state.playbackStatus.isPlaying) {\n          self.player.didJustFinish = false;\n        }\n        if (self.player.props && self.player.props.listener && typeof self.player.props.listener.onPlaybackChange === 'function') {\n          self.player.props.listener.onPlaybackChange(evt);\n        }\n        self.skin.updateState({ playbackStatus: self.state.playbackStatus });\n        self.pluginManager.updatePlaybackStatus(self.state.playbackStatus);\n      },\n      onReadyForDisplay: function(evt) {\n        Logger.debug('onReadyForDisplay');\n      }\n    };\n\n    this.pluginManager = new PluginManager(this.player.props);\n  }\n\n  static get Event() {\n    return PlayerEvent;\n  }\n\n  async init() {\n    this.entityDetail = null;\n    if (this.player.props.stream === 'vod') {\n      this.entityDetail = await API.getEntityDetail(this.player.props.api, this.player.props.token, this.player.props.entityId);\n    }\n\n    this.player.playbackToken = await API.getPlaybackToken(this.player.props.api, this.player.props.appId, this.player.props.entityId);\n\n    this.player.cdnListFull = [];\n    this.player.cdnList = [];\n\n    let res = null;\n    if (this.player.props.stream === 'vod') {\n      res = await API.getCDNVod(this.player.props.env, this.player.playbackToken,\n        this.player.props.appId, this.player.props.entityId);\n    } else if (this.player.props.stream === 'live') {\n      res = await API.getCDNLive(this.player.props.env, this.player.playbackToken,\n        this.player.props.appId, this.player.props.entityId,\n        this.player.props.streamName, this.player.props.region);\n    }\n\n    if (res && res.data && res.data.cdn) {\n      this.player.cdnListFull = res.data.cdn\n      this.player.cdnList = []\n      await Promise\n        .all(res.data.cdn)\n        .then(cdns => {\n          return cdns.map(cdn => {\n            this.player.cdnList.push(cdn.host);\n          });\n        });\n    }\n    this.pluginManager.init(this.player, {\n      cdnList: this.player.cdnList,\n      entityDetail: this.entityDetail\n    });\n\n    this.player.inited = true;\n\n    return this.player.inited;\n  }\n\n  get didJustFinish() {\n    return this.player.didJustFinish;\n  }\n\n  toggleFullscreen() {\n    Logger.debug('toggleFullscreen: ', this.state.fullsceenState);\n    try {\n      if (this.state.fullsceenState === FullscreenState.ENTER || this.state.fullsceenState === FullscreenState.ENTERING) {\n        this.exitFullscreen();\n        this.player.listener.onFullscreenUpdate(FullscreenState.EXIT);\n      } else {\n        this.enterFullscreen();\n        this.player.listener.onFullscreenUpdate(FullscreenState.ENTER);\n      }\n    } catch(e) {}\n  }\n\n  enterFullscreen() {\n    try {\n      // this.player.video.presentFullscreenPlayer();\n      this.state.fullsceenState = FullscreenState.ENTERING;\n      StatusBar.setHidden(true);\n      this.state.fullsceenState = FullscreenState.ENTER;\n\n      this.setState(previousState => {\n        return { fullsceenState: FullscreenState.ENTER };\n      });\n      ScreenOrientation.allow(ScreenOrientation.Orientation.LANDSCAPE);\n    } catch(e) {}\n  }\n\n  exitFullscreen() {\n    try {\n      // this.player.video.dismissFullscreenPlayer();\n      this.state.fullsceenState = FullscreenState.EXITING;\n      StatusBar.setHidden(false);\n      this.state.fullsceenState = FullscreenState.EXIT;\n\n      this.setState(previousState => {\n        return { fullsceenState: FullscreenState.EXIT };\n      });\n      ScreenOrientation.allow(ScreenOrientation.Orientation.ALL);\n    } catch(e) {}\n  }\n\n  togglePlayPause() {\n    try {\n      if (this.state.playbackStatus.isPlaying) {\n        this.pause();\n      } else {\n        this.play();\n      }\n    } catch(e) {}\n  }\n\n  pause() {\n    try {\n      this.player.video.pauseAsync();\n      this.skin.show();\n    } catch (e) { }\n  }\n\n  /* position in second */\n  play(position) {\n    try {\n      if (this.player.didJustFinish) {\n        this.player.didJustFinish = false;\n        this.pluginManager.emit('replay');\n      }\n      if (typeof position === 'undefined') {\n        this.player.video.playAsync();\n      } else {\n        this.player.video.playFromPositionAsync(position * 1000);\n      }\n      this.skin.show();\n    } catch (e) { }\n  }\n\n  /* position in second */\n  backward(position) {\n    try {\n      if (this.state.playbackStatus) {\n        let positionMillis = position * 1000;\n        positionMillis = this.state.playbackStatus.positionMillis - positionMillis;\n        if (positionMillis < 0) {\n          positionMillis = 0;\n        }\n        this.player.video.setPositionAsync(positionMillis);\n      }\n    } catch (e) { }\n  }\n\n  /* position in second */\n  forward(position) {\n    try {\n      if (this.state.playbackStatus) {\n        let positionMillis = position * 1000;\n        positionMillis = this.state.playbackStatus.positionMillis + positionMillis;\n        if (positionMillis > this.state.playbackStatus.durationMillis - 1e4) {\n          positionMillis = this.state.playbackStatus.durationMillis - 1e4;\n        }\n        this.player.video.setPositionAsync(positionMillis);\n      }\n    } catch (e) { }\n  }\n\n  seek(position, forceSeek = false) {\n    try {\n      let positionMillis = position * 1000;\n      if (!forceSeek && positionMillis > this.state.playbackStatus.durationMillis - 2000) {\n        positionMillis = this.state.playbackStatus.durationMillis - 2000;\n      }\n      if (positionMillis < 0) {\n        positionMillis = 0;\n      }\n      this.player.video.setPositionAsync(positionMillis);\n    } catch (e) { }\n  }\n\n  // shouldComponentUpdate(nextProps, nextState) {\n  //   return false;\n  // }\n\n  render() {\n    const size = Dimensions.get('screen');\n    const height169 = Math.floor(size.width * 9 / 16);\n\n    const view = (\n      <View {...this.props}\n        style={[styles.container, this.state.fullsceenState == FullscreenState.ENTER ? { position: 'absolute', zIndex: 9999, top: 0, left: 0, height: this.state.fullscreenHeight, width: this.state.fullscreenWidth } : { height: height169 }]}\n        ref={\n          component => {\n            this.container = component;\n          }\n        }>\n        <Video\n          ref={\n            component => {\n              this.player.video = component;\n            }\n          }\n          useNativeControls={false}\n          isLooping={false}\n          resizeMode={Expo.Video.RESIZE_MODE_CONTAIN}\n          style={styles.video}\n          onError={this.player.listener.onError}\n          onFullscreenUpdate={this.player.listener.onFullscreenUpdate}\n          onLoad={this.player.listener.onLoad}\n          onLoadStart={this.player.listener.onLoadStart}\n          onPlaybackStatusUpdate={this.player.listener.onPlaybackStatusUpdate}\n          onReadyForDisplay={this.player.listener.onReadyForDisplay}\n        />\n        <SkinUiza\n          ref={\n            component => {\n              this.skin = component;\n            }\n          }\n          style={styles.skin}\n          stream={this.player.props.stream}\n          player={this}\n          playbackStatus={this.state.playbackStatus}\n        />\n      </View>\n    );\n\n    let self = this;\n    Promise.resolve(self.init()).then(async function(res) {\n      if (self.player.video) {\n        try {\n          if (self.player.props && self.player.props.listener &&\n            typeof self.player.props.listener.onReady === 'function') {\n            self.player.props.listener.onReady();\n          }\n          let url = null;\n          if (self.player.props.stream === 'vod') {\n            url = self.definedLinkPlayVod();\n          } else if (self.player.props.stream === 'live') {\n            url = self.definedLinkPlayLive();\n          }\n\n          await self.player.video.loadAsync({ uri: url });\n          await self.player.video.setStatusAsync({\n            positionMillis: 0, // for resume\n            isLooping: false,\n            shouldPlay: true\n          });\n\n        } catch (e) {\n          self.skin.updateState({ playbackStatus: self.state.playbackStatus });\n          self.skin.hide();\n          Logger.debug('error: ', e.message);\n        }\n      }\n    });\n\n    this.readyTime = Date.now();\n    this.player.pageLoadTime = this.readyTime - this.initTime;\n\n    return view;\n  }\n\n  definedLinkPlayVod() {\n    try {\n      let prefix = 'playlist_ts.m3u8';\n      if (Platform.OS === 'ios' && parseInt(Platform.Version, 10) >= 10) { // iOS >= 10\n        prefix = 'playlist.m3u8'; // hls\n      } else if (Platform.OS === 'android' && parseInt(Platform.Version, 10) >= 16) { // android API 16 ~ android 4.1\n        prefix = 'manifest.mpd'; // dash\n      }\n      if (this.player.props.playerName === 'vod') {\n        prefix = 'playlist_ts.m3u8';\n      }\n  \n      return `https://${this.player.cdnList[0]}/${this.player.props.appId}-stream/${this.player.props.entityId}/package/${prefix}`\n    } catch(e) {\n      self.skin.updateState({ playbackStatus: self.state.playbackStatus });\n      self.skin.hide();\n      Logger.debug('error: ', e.message);\n      return null;\n    }\n  }\n\n  definedLinkPlayLive() {\n    try {\n      let prefix = 'playlist_ts.m3u8';\n      if (Platform.OS === 'ios' && parseInt(Platform.Version, 10) >= 10) { // iOS >= 10\n        prefix = 'playlist.m3u8'; // hls\n      } else if (Platform.OS === 'android' && parseInt(Platform.Version, 10) >= 16) { // android API 16 ~ android 4.1\n        prefix = 'manifest.mpd'; // dash\n      }\n      if (this.player.props.playerName === 'vod') {\n        prefix = 'playlist_ts.m3u8';\n      }\n  \n      return `https://${this.player.cdnList[0]}/${this.player.props.appId}-live/${this.player.props.streamName}/${prefix}`\n    } catch(e) {\n      self.skin.updateState({ playbackStatus: self.state.playbackStatus });\n      self.skin.hide();\n      Logger.debug('error: ', e.message);\n      return null;\n    }\n  }\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    backgroundColor: 'black',\n    width: '100%',\n  },\n  video: {\n    position: 'absolute',\n    zIndex: 0,\n    top: 0,\n    left: 0,\n\n    width: '100%',\n    height: '100%',\n  },\n  skin: {\n    position: 'absolute',\n    zIndex: 99999,\n    top: 0,\n    left: 0,\n\n    width: '100%',\n    height: '100%',\n  }\n});\n"]}