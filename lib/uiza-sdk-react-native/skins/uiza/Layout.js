Object.defineProperty(exports,"__esModule",{value:true});exports.default=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};var _jsxFileName='src/skins/uiza/Layout.js';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _react=require('react');var _react2=_interopRequireDefault(_react);var _reactNative=require('react-native');var _Backward10Icon=require('./Backward10Icon');var _Backward10Icon2=_interopRequireDefault(_Backward10Icon);var _DividerDisplay=require('./DividerDisplay');var _DividerDisplay2=_interopRequireDefault(_DividerDisplay);var _Forward10Icon=require('./Forward10Icon');var _Forward10Icon2=_interopRequireDefault(_Forward10Icon);var _LoadingIcon=require('./LoadingIcon');var _LoadingIcon2=_interopRequireDefault(_LoadingIcon);var _OnOffFullscreenIcon=require('./OnOffFullscreenIcon');var _OnOffFullscreenIcon2=_interopRequireDefault(_OnOffFullscreenIcon);var _PlayPauseIcon=require('./PlayPauseIcon');var _PlayPauseIcon2=_interopRequireDefault(_PlayPauseIcon);var _TimeDisplay=require('./TimeDisplay');var _TimeDisplay2=_interopRequireDefault(_TimeDisplay);var _TimeSlider=require('./TimeSlider');var _TimeSlider2=_interopRequireDefault(_TimeSlider);var _Utils=require('../../utils/Utils');var _Utils2=_interopRequireDefault(_Utils);var _Message=require('./Message.js');var _Message2=_interopRequireDefault(_Message);var _reactNativeSvg=require('react-native-svg');var _reactNativeSvg2=_interopRequireDefault(_reactNativeSvg);var _MutedUnmutedIcon=require('./MutedUnmutedIcon');var _MutedUnmutedIcon2=_interopRequireDefault(_MutedUnmutedIcon);var _TopTitle=require('./TopTitle');var _TopTitle2=_interopRequireDefault(_TopTitle);var _API=require('../../API');var _API2=_interopRequireDefault(_API);var _lodash=require('lodash');var _=_interopRequireWildcard(_lodash);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj.default=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var TIMEOUT_VISIBLE=5e3;var SkinUiza=function(_React$Component){_inherits(SkinUiza,_React$Component);function SkinUiza(props){_classCallCheck(this,SkinUiza);var _this=_possibleConstructorReturn(this,(SkinUiza.__proto__||Object.getPrototypeOf(SkinUiza)).call(this,props));_this.state={fadeControlAnim:new _reactNative.Animated.Value(1),showing:true,playbackStatus:props.playbackStatus};_this.uzPlayer=props.player;_this.playerProps=props.playerProps;_this.triggerFirstPlay=false;if(props.entityDetail){_this.entityDetail=props.entityDetail;}_this.liveDetail=props.liveDetail;_this._getLiveDetail();return _this;}_createClass(SkinUiza,[{key:'updateState',value:function updateState(state){var self=this;Object.getOwnPropertyNames(state).filter(function(pro){self.state[pro]=state[pro];});if(this.loadingIcon){this.loadingIcon.setState(this.state);}if(this.playPauseIcon){this.playPauseIcon.setState(this.state);}if(this.onOffFullscreenIcon){this.onOffFullscreenIcon.setState(this.state);}if(this.timeDisplay){this.timeDisplay.setState(this.state);}if(this.timeSlider&&!this.timeSlider.state.dragging){this.timeSlider.setState(this.state);}if(!this.triggerFirstPlay&&this.state.playbackStatus&&this.state.playbackStatus.isPlaying){this.triggerFirstPlay=true;this.show();}if(this.topTitle){this.topTitle.setState(this.state);}if(this.mutedUnmutedIcon){this.mutedUnmutedIcon.setState(this.state);}}},{key:'updateEntityProps',value:function updateEntityProps(props){if(props){this.entityDetail=props;}}},{key:'updateLiveStatusProps',value:function updateLiveStatusProps(props){if(props){this.setState({playbackStatus:{error:props}});if(this.timeDisplay){this.timeDisplay.setState(this.state);}}}},{key:'toggleShow',value:function toggleShow(){if(this.state.showing&&this.state.playbackStatus&&!this.state.playbackStatus.isPlaying){return;}this.state.showing?this.hide():this.show();}},{key:'show',value:function show(){this.setState({showing:true});var self=this;setTimeout(function(){_reactNative.Animated.timing(self.state.fadeControlAnim,{toValue:1,easing:_reactNative.Easing.back(),duration:100}).start();},200);if(this.timeoutVisible){clearTimeout(this.timeoutVisible);}self.timeoutVisible=setTimeout(function(){self.hide();},TIMEOUT_VISIBLE);}},{key:'hide',value:function hide(){var _this2=this;if(this.state.playbackStatus&&!this.state.playbackStatus.isPlaying||this.timeSlider&&this.timeSlider.state.dragging){return;}_reactNative.Animated.timing(this.state.fadeControlAnim,{toValue:0,easing:_reactNative.Easing.back(),duration:100}).start(function(){_this2.setState({showing:false});});}},{key:'render',value:function render(){var _this3=this;var view=void 0;var fadeControlAnim=this.state.fadeControlAnim;if(this.props.stream==='live'){view=_react2.default.createElement(_reactNative.TouchableWithoutFeedback,{onPress:this._toggleControls.bind(this),__source:{fileName:_jsxFileName,lineNumber:139}},_react2.default.createElement(_reactNative.View,_extends({},this.props,{style:styles.view,__source:{fileName:_jsxFileName,lineNumber:140}}),!this.state.showing?null:!this.entityDetail?null:_react2.default.createElement(_reactNative.Animated.View,{style:[styles.bottom,{opacity:fadeControlAnim}],__source:{fileName:_jsxFileName,lineNumber:146}},_react2.default.createElement(_TopTitle2.default,{ref:function ref(component){_this3.topTitle=component;},player:this.uzPlayer,topTitle:this.entityDetail,playerLiveDetail:this.entityDetail,playerProps:this.props.stream,liveDetail:this.liveDetail,__source:{fileName:_jsxFileName,lineNumber:147}})),_react2.default.createElement(_reactNative.View,{style:[styles.loading,this.uzPlayer.didJustFinish?styles.zIndexTop:styles.zIndexBottom],__source:{fileName:_jsxFileName,lineNumber:163}},this.uzPlayer.didJustFinish?_react2.default.createElement(_reactNative.TouchableWithoutFeedback,{onPress:this._toggleReplay.bind(this),__source:{fileName:_jsxFileName,lineNumber:166}},_react2.default.createElement(_reactNative.View,{style:[styles.iconReload],__source:{fileName:_jsxFileName,lineNumber:167}},_react2.default.createElement(_reactNativeSvg2.default,{width:'48',height:'100%',viewBox:'-24 -24 96 96',__source:{fileName:_jsxFileName,lineNumber:168}},_react2.default.createElement(_reactNativeSvg.G,{id:'Page-1',stroke:'none','stroke-width':'1',fill:'none','fill-rule':'evenodd',__source:{fileName:_jsxFileName,lineNumber:169}},_react2.default.createElement(_reactNativeSvg.G,{id:'icon/replay',__source:{fileName:_jsxFileName,lineNumber:170}},_react2.default.createElement(_reactNativeSvg.G,{id:'Page-1',__source:{fileName:_jsxFileName,lineNumber:171}},_react2.default.createElement(_reactNativeSvg.Path,{d:'M42.2487373,31.1237373 L29.1237373,31.1237373 L34.0295479,36.0295479 C31.5504952,38.5084639 28.2545479,39.8737373 24.7487373,39.8737373 C21.2429268,39.8737373 17.9469795,38.5084639 15.4679268,36.0295479 C12.9890108,33.5504952 11.6237373,30.2545479 11.6237373,26.7487373 C11.6237373,23.2429268 12.9890108,19.9469795 15.4679268,17.4679268 C17.9469795,14.9890108 21.2429268,13.6237373 24.7487373,13.6237373 C28.2545479,13.6237373 31.5504952,14.9890108 34.0294795,17.4679952 C34.2364717,17.674919 34.4348506,17.8881319 34.6261202,18.1060616 L37.9183077,15.2253291 C34.7106807,11.5624287 30.0001045,9.24873734 24.7487373,9.24873734 C15.0837471,9.24873734 7.24873734,17.0837471 7.24873734,26.7487373 C7.24873734,36.4137276 15.0837471,44.2487373 24.7487373,44.2487373 C29.5812666,44.2487373 33.9556514,42.2893526 37.1223311,39.1223311 L42.2487373,44.2487373 L42.2487373,31.1237373 Z',id:'Fill-2',fill:'#FFFFFF','fill-rule':'nonzero',transform:'translate(24.748737, 26.748737) rotate(-135.000000) translate(-24.748737, -26.748737) ',__source:{fileName:_jsxFileName,lineNumber:172}}))))))):this.state.playbackStatus.error?_react2.default.createElement(_Message2.default,{ref:function ref(component){_this3.message=component;},messageState:this.state,__source:{fileName:_jsxFileName,lineNumber:183}}):_react2.default.createElement(_LoadingIcon2.default,{ref:function ref(component){_this3.loadingIcon=component;},skinState:this.state,__source:{fileName:_jsxFileName,lineNumber:191}})),_react2.default.createElement(_reactNative.ScrollView,{__source:{fileName:_jsxFileName,lineNumber:200}}),this.state.showing?_react2.default.createElement(_reactNative.Animated.View,{style:[styles.bottom,{height:50,opacity:fadeControlAnim}],__source:{fileName:_jsxFileName,lineNumber:203}},_react2.default.createElement(_reactNative.View,{style:[styles.controls,{height:50}],__source:{fileName:_jsxFileName,lineNumber:204}},_react2.default.createElement(_PlayPauseIcon2.default,{ref:function ref(component){_this3.playPauseIcon=component;},player:this.props.player,skinState:this.state,__source:{fileName:_jsxFileName,lineNumber:205}}),_react2.default.createElement(_MutedUnmutedIcon2.default,{ref:function ref(component){_this3.mutedUnmutedIcon=component;},player:this.props.player,skinState:this.state,__source:{fileName:_jsxFileName,lineNumber:214}}),_react2.default.createElement(_TimeDisplay2.default,{ref:function ref(component){_this3.timeDisplay=component;},stream:this.props.stream,player:this.props.player,skinState:this.state,__source:{fileName:_jsxFileName,lineNumber:223}}),_react2.default.createElement(_DividerDisplay2.default,{__source:{fileName:_jsxFileName,lineNumber:233}}),_react2.default.createElement(_OnOffFullscreenIcon2.default,{ref:function ref(component){_this3.onOffFullscreenIcon=component;},player:this.props.player,skinState:this.state,__source:{fileName:_jsxFileName,lineNumber:234}}))):null));}else{view=_react2.default.createElement(_reactNative.TouchableWithoutFeedback,{onPress:this._toggleControls.bind(this),__source:{fileName:_jsxFileName,lineNumber:251}},_react2.default.createElement(_reactNative.View,_extends({},this.props,{style:styles.view,__source:{fileName:_jsxFileName,lineNumber:252}}),!this.state.showing?null:!this.entityDetail?null:_react2.default.createElement(_reactNative.Animated.View,{style:[styles.bottom,{opacity:fadeControlAnim}],__source:{fileName:_jsxFileName,lineNumber:258}},_react2.default.createElement(_TopTitle2.default,{ref:function ref(component){_this3.topTitle=component;},topTitle:this.entityDetail,__source:{fileName:_jsxFileName,lineNumber:259}})),_react2.default.createElement(_reactNative.View,{style:[styles.loading,this.uzPlayer.didJustFinish?styles.zIndexTop:styles.zIndexBottom],__source:{fileName:_jsxFileName,lineNumber:268}},this.uzPlayer.didJustFinish?_react2.default.createElement(_reactNative.TouchableWithoutFeedback,{onPress:this._toggleReplay.bind(this),__source:{fileName:_jsxFileName,lineNumber:271}},_react2.default.createElement(_reactNative.View,{style:[styles.iconReload],__source:{fileName:_jsxFileName,lineNumber:272}},_react2.default.createElement(_reactNativeSvg2.default,{width:'90',height:'100%',viewBox:'-24 -24 96 96',__source:{fileName:_jsxFileName,lineNumber:273}},_react2.default.createElement(_reactNativeSvg.G,{id:'Page-1','stroke-width':'2',fill:'none','fill-rule':'evenodd',stroke:'black',__source:{fileName:_jsxFileName,lineNumber:274}},_react2.default.createElement(_reactNativeSvg.G,{id:'icon/replay',__source:{fileName:_jsxFileName,lineNumber:275}},_react2.default.createElement(_reactNativeSvg.G,{id:'Page-1',__source:{fileName:_jsxFileName,lineNumber:276}},_react2.default.createElement(_reactNativeSvg.Path,{d:'M42.2487373,31.1237373 L29.1237373,31.1237373 L34.0295479,36.0295479 C31.5504952,38.5084639 28.2545479,39.8737373 24.7487373,39.8737373 C21.2429268,39.8737373 17.9469795,38.5084639 15.4679268,36.0295479 C12.9890108,33.5504952 11.6237373,30.2545479 11.6237373,26.7487373 C11.6237373,23.2429268 12.9890108,19.9469795 15.4679268,17.4679268 C17.9469795,14.9890108 21.2429268,13.6237373 24.7487373,13.6237373 C28.2545479,13.6237373 31.5504952,14.9890108 34.0294795,17.4679952 C34.2364717,17.674919 34.4348506,17.8881319 34.6261202,18.1060616 L37.9183077,15.2253291 C34.7106807,11.5624287 30.0001045,9.24873734 24.7487373,9.24873734 C15.0837471,9.24873734 7.24873734,17.0837471 7.24873734,26.7487373 C7.24873734,36.4137276 15.0837471,44.2487373 24.7487373,44.2487373 C29.5812666,44.2487373 33.9556514,42.2893526 37.1223311,39.1223311 L42.2487373,44.2487373 L42.2487373,31.1237373 Z',id:'Fill-2',fill:'#FFFFFF','fill-rule':'nonzero',transform:'translate(24.748737, 26.748737) rotate(-135.000000) translate(-24.748737, -26.748737) ',__source:{fileName:_jsxFileName,lineNumber:277}}))))))):this.state.playbackStatus.error?_react2.default.createElement(_Message2.default,{ref:function ref(component){_this3.message=component;},messageState:this.state,__source:{fileName:_jsxFileName,lineNumber:288}}):_react2.default.createElement(_LoadingIcon2.default,{ref:function ref(component){_this3.loadingIcon=component;},skinState:this.state,__source:{fileName:_jsxFileName,lineNumber:296}})),_react2.default.createElement(_reactNative.ScrollView,{__source:{fileName:_jsxFileName,lineNumber:305}}),this.state.showing?_react2.default.createElement(_reactNative.Animated.View,{style:[styles.bottom,{opacity:fadeControlAnim}],__source:{fileName:_jsxFileName,lineNumber:308}},_react2.default.createElement(_TimeSlider2.default,{style:styles.timeSlider,ref:function ref(component){_this3.timeSlider=component;},player:this.props.player,skinState:this.state,__source:{fileName:_jsxFileName,lineNumber:309}}),_react2.default.createElement(_reactNative.View,{style:styles.controls,__source:{fileName:_jsxFileName,lineNumber:318}},_react2.default.createElement(_PlayPauseIcon2.default,{ref:function ref(component){_this3.playPauseIcon=component;},player:this.props.player,skinState:this.state,__source:{fileName:_jsxFileName,lineNumber:319}}),_react2.default.createElement(_Backward10Icon2.default,{player:this.props.player,__source:{fileName:_jsxFileName,lineNumber:329}}),_react2.default.createElement(_Forward10Icon2.default,{player:this.props.player,staskinStatete:this.state,__source:{fileName:_jsxFileName,lineNumber:332}}),_react2.default.createElement(_MutedUnmutedIcon2.default,{ref:function ref(component){_this3.mutedUnmutedIcon=component;},player:this.props.player,skinState:this.state,__source:{fileName:_jsxFileName,lineNumber:336}}),_react2.default.createElement(_TimeDisplay2.default,{ref:function ref(component){_this3.timeDisplay=component;},skinState:this.state,__source:{fileName:_jsxFileName,lineNumber:345}}),_react2.default.createElement(_DividerDisplay2.default,{__source:{fileName:_jsxFileName,lineNumber:353}}),_react2.default.createElement(_OnOffFullscreenIcon2.default,{ref:function ref(component){_this3.onOffFullscreenIcon=component;},player:this.props.player,skinState:this.state,__source:{fileName:_jsxFileName,lineNumber:354}}))):null));}return view;}},{key:'_toggleControls',value:function _toggleControls(){this.toggleShow();}},{key:'_toggleReplay',value:function _toggleReplay(){_Utils.Logger.debug('_toggleReplay');this.uzPlayer.play(0);}},{key:'_getLiveDetail',value:function _getLiveDetail(){var _this4=this;try{var self=this;var playerProps=_.cloneDeep(self.playerProps);if(playerProps&&playerProps.api&&playerProps.token&&playerProps.entityId){setInterval(function _callee(){return regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return regeneratorRuntime.awrap(_API2.default.getLiveView(playerProps.api,playerProps.token,playerProps.entityId,null));case 2:self.liveDetail=_context.sent;_this4.topTitle?_this4.topTitle._getLiveDetail(self.liveDetail):null;case 4:case'end':return _context.stop();}}},null,_this4);},5000);}}catch(e){_Utils.Logger.debug('_getLiveDetail error ',e.message);}}}]);return SkinUiza;}(_react2.default.Component);exports.default=SkinUiza;var styles=_reactNative.StyleSheet.create({view:{width:'100%',height:'100%',backgroundColor:'rgba(255, 255, 255, 0)'},loading:{position:'absolute',height:'100%',width:'100%',justifyContent:'center'},zIndexTop:{zIndex:99,backgroundColor:'rgba(0, 0, 0, .5)'},zIndexBottom:{zIndex:0},bottom:{width:'100%',height:60},timeSlider:{width:'100%'},controls:{position:'absolute',bottom:0,width:'100%',height:60,flexDirection:'row',backgroundColor:'rgba(0, 0, 0, .1)'},iconReload:{flex:1,width:'100%',height:'100%',flexDirection:'row',justifyContent:'space-around',padding:10,alignSelf:'center',position:'absolute',bottom:30,zIndex:100}});
//# sourceMappingURL=Layout.js.map