{"version":3,"sources":["../../../../src/skins/uiza/Layout.js"],"names":["TIMEOUT_VISIBLE","SkinUiza","props","state","fadeControlAnim","Animated","Value","showing","playbackStatus","uzPlayer","player","triggerFirstPlay","self","Object","getOwnPropertyNames","filter","pro","loadingIcon","setState","playPauseIcon","onOffFullscreenIcon","timeDisplay","timeSlider","dragging","isPlaying","show","hide","setTimeout","timing","toValue","easing","Easing","back","duration","start","timeoutVisible","clearTimeout","length","view","stream","_toggleControls","bind","styles","loading","error","message","component","bottom","height","opacity","controls","toggleShow","React","Component","StyleSheet","create","width","backgroundColor","zIndex","position","justifyContent","flexDirection"],"mappings":"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","file":"Layout.js","sourcesContent":["import React from 'react';\nimport { Animated, Easing, ScrollView, StyleSheet, TouchableWithoutFeedback, View } from 'react-native';\nimport Backward10Icon from './Backward10Icon';\nimport DividerDisplay from './DividerDisplay';\nimport Forward10Icon from './Forward10Icon';\nimport LoadingIcon from './LoadingIcon';\nimport OnOffFullscreenIcon from './OnOffFullscreenIcon';\nimport PlayPauseIcon from './PlayPauseIcon';\nimport TimeDisplay from './TimeDisplay';\nimport TimeSlider from './TimeSlider';\nimport Utils, { Logger } from '../../utils/Utils';\nimport Message from './Message.js';\n\nconst TIMEOUT_VISIBLE = 5e3;\n\nexport default class SkinUiza extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      fadeControlAnim: new Animated.Value(1),\n      showing: true,\n      playbackStatus: props.playbackStatus\n    };\n    this.uzPlayer = props.player;\n    this.triggerFirstPlay = false;\n  }\n\n  updateState(state) {\n    let self = this;\n    Object.getOwnPropertyNames(state).filter(function(pro) {\n      self.state[pro] = state[pro];\n    })\n    if (this.loadingIcon) {\n      this.loadingIcon.setState(this.state);\n    }\n    if (this.playPauseIcon) {\n      this.playPauseIcon.setState(this.state);\n    }\n    if (this.onOffFullscreenIcon) {\n      this.onOffFullscreenIcon.setState(this.state);\n    }\n    if (this.timeDisplay) {\n      this.timeDisplay.setState(this.state);\n    }\n    if (this.timeSlider && !this.timeSlider.state.dragging) {\n      this.timeSlider.setState(this.state);\n    }\n    if (!this.triggerFirstPlay && this.state.playbackStatus && this.state.playbackStatus.isPlaying) {\n      this.triggerFirstPlay = true;\n      this.show();\n    }\n  }\n\n  toggleShow() {\n    if (this.state.showing && this.state.playbackStatus && !this.state.playbackStatus.isPlaying) {\n      return;\n    }\n    this.state.showing ? this.hide() : this.show();\n  }\n\n  show() {\n    this.setState({ showing: true });\n    let self = this;\n    setTimeout(function(){\n      Animated.timing(\n        self.state.fadeControlAnim,\n        {\n          toValue: 1,\n          easing: Easing.back(),\n          duration: 750,\n        }\n      ).start();\n    }, 200);\n    if (this.timeoutVisible) {\n      clearTimeout(this.timeoutVisible);\n    }\n    // let self = this;\n    self.timeoutVisible = setTimeout(function() {\n      self.hide();\n    }, TIMEOUT_VISIBLE);\n  }\n\n  hide() {\n    if ((this.state.playbackStatus && this.state.playbackStatus.length>0 && !this.state.playbackStatus.isPlaying) ||\n      (this.timeSlider && this.timeSlider.state.dragging)) {\n      return;\n    }\n    Animated.timing(\n      this.state.fadeControlAnim,\n      {\n        toValue: 0,\n        easing: Easing.back(),\n        duration: 750,\n      }\n    ).start(()=>{\n      this.setState({ showing: false });\n    });\n  }\n\n  render() {\n    let view;\n    let { fadeControlAnim } = this.state;\n\n    if (this.props.stream === 'live') {\n      view = (\n        <TouchableWithoutFeedback onPress={this._toggleControls.bind(this)}>\n          <View\n            {...this.props}\n            style={styles.view}>\n            <View style={styles.loading}>\n              {\n                this.state.playbackStatus.error ?\n                <Message\n                  ref={\n                    component => {\n                      this.message = component;\n                    }\n                  }\n                  messageState={this.state} />\n                  :\n                <LoadingIcon\n                  ref={\n                    component => {\n                      this.loadingIcon = component;\n                    }\n                  }\n                  skinState={this.state} />\n              }\n            </View>\n            <ScrollView></ScrollView>\n            {\n              this.state.showing ?\n                <Animated.View style={[styles.bottom, { height: 50, opacity: fadeControlAnim }]}>\n                  <View style={[styles.controls, { height: 50 }]}>\n                    <PlayPauseIcon\n                      ref={\n                        component => {\n                          this.playPauseIcon = component;\n                        }\n                      }\n                      player={this.props.player}\n                      skinState={this.state}\n                    />\n                    <TimeDisplay\n                      ref={\n                        component => {\n                          this.timeDisplay = component;\n                        }\n                      }\n                      stream={this.props.stream}\n                      player={this.props.player}\n                      skinState={this.state}\n                    />\n                    <DividerDisplay />\n                    <OnOffFullscreenIcon\n                      ref={\n                        component => {\n                          this.onOffFullscreenIcon = component;\n                        }\n                      }\n                      player={this.props.player}\n                      skinState={this.state}\n                    />\n                  </View>\n                </Animated.View> : null\n            }\n          </View>\n        </TouchableWithoutFeedback>\n      )\n    } else {\n      view = (\n        <TouchableWithoutFeedback onPress={this._toggleControls.bind(this)}>\n          <View\n            {...this.props}\n            style={styles.view}>\n            <View style={styles.loading}>\n              {\n                this.state.playbackStatus.error ?\n                <Message\n                  ref={\n                    component => {\n                      this.message = component;\n                    }\n                  }\n                  messageState={this.state} />\n                  :\n                <LoadingIcon\n                  ref={\n                    component => {\n                      this.loadingIcon = component;\n                    }\n                  }\n                  skinState={this.state} />\n              }\n            </View>\n            <ScrollView></ScrollView>\n            {\n              this.state.showing ?\n                <Animated.View style={[styles.bottom, { opacity: fadeControlAnim }]}>\n                  <TimeSlider style={styles.timeSlider}\n                    ref={\n                      component => {\n                        this.timeSlider = component;\n                      }\n                    }\n                    player={this.props.player}\n                    skinState={this.state}\n                  />\n                  <View style={styles.controls}>\n                    <PlayPauseIcon\n                      ref={\n                        component => {\n                          this.playPauseIcon = component;\n                        }\n                      }\n                      player={this.props.player}\n                      skinState={this.state}\n                    />\n                    <Backward10Icon\n                      player={this.props.player}\n                    />\n                    <Forward10Icon\n                      player={this.props.player}\n                      staskinStatete={this.state}\n                    />\n                    <TimeDisplay\n                      ref={\n                        component => {\n                          this.timeDisplay = component;\n                        }\n                      }\n                      skinState={this.state}\n                    />\n                    <DividerDisplay />\n                    <OnOffFullscreenIcon\n                      ref={\n                        component => {\n                          this.onOffFullscreenIcon = component;\n                        }\n                      }\n                      player={this.props.player}\n                      skinState={this.state}\n                    />\n                  </View>\n                </Animated.View> : null\n            }\n          </View>\n        </TouchableWithoutFeedback>\n      )\n    }\n\n    return view;\n  }\n\n  _toggleControls() {\n    this.toggleShow();\n  }\n}\n\nconst styles = StyleSheet.create({\n  view: {\n    width: '100%',\n    height: '100%',\n    backgroundColor: 'rgba(255, 255, 255, 0)'\n  },\n  loading: {\n    zIndex: 0,\n    position: 'absolute',\n    height: '100%',\n    width: '100%',\n    justifyContent: 'center'\n  },\n  bottom: {\n    width: '100%',\n    height: 60,\n  },\n  timeSlider: {\n    width: '100%'\n  },\n  controls: {\n    position: 'absolute',\n    bottom: 0,\n    width: '100%',\n    height: 60,\n    flexDirection: 'row',\n    backgroundColor: 'rgba(0, 0, 0, .1)'\n  }\n});\n"]}